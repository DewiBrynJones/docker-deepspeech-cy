#!/usr/bin/env python3
# -*- coding: utf-8 -*-
import re

from WelshTokenization import WelshTokenization
tokenizer=WelshTokenization()


FIND_REPLACE = [
   (" ok ", " oce "),
   (' 000 ', ' dim dim dim '),
   (' 0000000000 ', ' dim dim dim dim dim dim dim dim dim dim '),
   (' 1 ', ' un '),
   (' 2 ', ' dau '),
   (' 3 ', ' tri '),
   (' 4 ', ' pedwar '),
   (' 5 ', ' pump '), 
   (' 6 ', ' chwech '), 
   (' 7 ', ' saith '),
   (' 8 ', ' wyth '),
   (' 9 ', ' naw '),
   (' 10 ', ' deg '),
   (' 11 ', ' un ar ddeg '), 
   (' 12 ', ' deuddeg '), 
   (' 16 ', ' un deg chwech '), 
   (' 20 ', ' ugain '), 
   (' 21 ', ' dau ddeg un '), 
   (' 23 ', ' dau ddeg tri '), 
   (' 24 ', ' dau ddeg pedwar '), 
   (' 30 ', ' tri deg '), 
   (' 37 ', ' tri deg saith '), 
   (' 40 ', ' pedwar deg '), 
   (' 45 ', ' pedwar deg pump '), 
   (' 49 ', ' pedwar deg naw '), 
   (' 50 ', ' hanner cant '), 
   (' 53 ', ' pum deg tri '), 
   (' 60 ', ' chwe deg '), 
   (' 75 ', ' saith deg pump '), 
   (' 80 ', ' wyth deg '), 
   (' 100 ', ' cant '), 
   (' 200 ', ' dau gant '), 
   (' 500 ', ' pum cant '), 
   (' 1000 ', ' mil '), 
   (' 1971 ', ' mil naw saith un '), 
   (' 1982 ', ' mil naw wyth dau '), 
   (' 2076 ', ' dwy fil saith deg chwech '), 
   (' 100% ', ' cant y cant '), 
   (' 40% ', ' pedwar deg y cant '), 
   (' 60% ', ' chwe deg y cant '), 
   (' £3 ', ' tair punt '), 
   (' £6 ', ' chwe phunt '), 
   (' £8 ', ' wyth punt '), 
   (' £9 ', ' naw punt '), 
   (' £10 ', ' deg punt '), 
   (' £15 ', ' pymtheg punt '), 
   (' £50 ', ' pum deg punt '), 
   (' £100 ', ' can punt '), 
   (' £150 ', ' cant pum deg punt '), 
   (' £299 ', ' dau gant naw deg naw punt '), 
   (' £1000 ', ' mil o bunoedd '), 
   (' £8000 ', ' wyth mil o bunoedd '),
   (' £9.20 ',' naw punt dau ddeg '),
   (' £8,000 ',' wyth mil o bunnoedd '),
   (' £3.60 ',' tair punt chwe deg '),
   (' £6,500 ',' chwe mil a hanner o bunoedd '),
   (' £299,000 ',' dau gant naw deg naw mil o bunoedd '),
   (' 10K ', ' ten k '), 
   (' 14S ', ' un deg pedwar s '), 
   (' 7C ', ' saith c '), 
   (' 9C ', ' naw c '), 
   (' A&E ', ' a and e '), 
   (' A470 ', ' a four seventy '),
   (' P45 ', ' p fourty five '), 
   (" Achos bod e 'n rhwyddach peidio . ", " <#B> Achos bod e 'n rhwyddach peidio . "), 
   (' gwerthfawro ', ' gwerthfawr o '), 
   ('  (  ', '  '), 
   ('  )  ', '  '), 
   ('  -  ', '  '), 
   (' -annwyd ', ' annwyd '), 
   (' -busnes ', ' busnes '), 
   (' -fatha ', ' fatha '), 
   ('  /  ', '  '), 
   ('  :  ', '  '), 
   ('  ;  ', '  '), 
   (' <#ACGOG ', ' <#ACGOG> '), 
   (' <#AGOG> ', ' <#ACGOG> '), 
   (' <#B ', ' <#B> '), 
   (' <#B><#ACGOG> ', ' <#B> <#ACGOG> '), 
   (' <#B>WYN ', ' <#B> wyn '), 
   (' <#CER ', ' <#CER> '), 
   (' <#G>DW ', ' <#G> dw '), 
   (' <#G>REIT ', ' <#G> reit '), 
   (" <#G>T'YD ", " <#G> t'yd "), 
   (' #G> ',' <#G> '),
   (' >G> ',' <G> '),
   (' <#N> ', ' <#B> '), 
   (' <ACGOG> ', ' <#ACGOG> '), 
   (' <B> ', ' <#B> '), 
   (' <CER> ', ' <#CER> '), 
   (' <G> ', ' <#G> '), 
   (' aa ', ' a '), 
   (' baf-tafs ', ' baf-tas '), 
   (' bod> ', ' bod '), 
   (' gamgymeriadyn ', ' gamgymeriad yn '), 
   (' grinderfydda ', ' grinder fydda '), 
   (' gwitsiadi ', ' gwitsiad i '), 
   (' gymorthi ', ' gymorth i '), 
   (' Lerpwlefo ', ' Lerpwl efo '), 
   (' o< ', ' o '), 
   (' ok> ', ' ok '), 
   (" p'nawnma ", " p'nawn ma "), 
   (' paratoidatganiad ', ' paratoi datganiad '), 
   (' shhh ', ' shh '), 
   (' www ', ' ww '), 
   (' yyy ', ' yy '), 
   (' ≤#B>  ', ' <#B> '), 
   (' § ',' ' ), 
   (" fan'ma "," fan 'ma "), 
   (" i'neud "," i neud "),
   (" fel'na "," fel 'na "),
   (" mae'na "," mae 'na "),
   (" on'd "," ond "),
   (" bore'ma "," bore 'ma "),
   (" fan'na "," fan 'na "),
   (" oes'na "," oes 'na "),
   (" lle'ma "," lle 'ma "), 
   (" does'na "," does 'na "), 
   (" 'di'neud "," 'di 'neud "),
   (" bora'ma "," bora 'ma "),
   (" o'ma "," o 'ma "),
   (" edrych'mlaen "," edrych 'mlaen "),
   (" fel'a "," fel 'a "),
   (" dere'mlaen "," dere 'mlaen "),
   (" yn'neud "," yn 'neud "),
   (" fa'ma "," fa 'ma "),
   (" dre'ma "," dre 'ma "),
   (" i'rioed "," i 'rioed "),
   (" sy'na "," sy 'na "),
   (" heno'ma "," heno 'ma "),
   (" bod'na "," bod 'na "),
   (" pnawn'ma "," pnawn 'ma "),
   (" da'ma "," da 'ma "),
   (" wneud'ma "," wneud 'ma "),
   (" nes'mlaen "," nes 'mlaen "),
   (" dishgwl'mlaen "," dishgwl 'mlaen "),
   (" fydd'na "," fydd 'na "),
   (" i'mond "," i 'mond "),
   (" fi'neud "," fi 'neud "),
   (" fan'no "," fan 'no "),
   (" sy'ma "," sy' 'ma "),
   (" prynhawn'ma "," prynhawn 'ma "),
   (" wel'na "," wel 'na "),
   (" i'ngweld "," i' ngweld "),
   (" mynd'mlaen "," mynd 'mlaen "),
   (" Kevin'na "," Kevin 'na "),
   (" ty'ma "," ty 'ma "),
   (" dewch'mlaen "," dewch 'mlaen "),
   (" hwyl'wan "," hwyl 'wan "),
   (" dere'ma "," dere 'ma "),
   (" mas'na "," mas 'na "),
   (" gweud'tho "," gweud 'tho "),
   (" diwetha'ma "," diwetha 'ma "),
   (" deud'tho "," deud 'tho "),
   (" stad'ma "," stad 'ma "),
   (' amdanno ',' amdano '),
   (" deud'tha "," deud 'tha "),
   (" bach'na "," bach 'na "),
   (" ysgol'ma "," ysgol 'ma "),
   (" os'neith "," os 'neith "),
   (" i'mod "," i 'mod "),
   (" twll'ma "," twll 'ma "),
   (" ti'neud "," ti 'neud "),
   (" mi'nei "," mi 'nei "),
   (" o's'na "," o's 'na "),
   (" o'mlaen "," o 'mlaen "),
   (" ni'neud "," ni 'neud "),
   (" fi'tha "," fi 'tha "),
   (" aros'ma "," aros 'ma "),
   (" heddiw'ma "," heddiw 'ma "),
   (" sgript'ma "," sgript 'ma "),
   (" sefyllfa'na "," sefyllfa 'na "),
   (" 'neud'wan "," 'neud 'wan "),
   (" gario'mlaen "," gario 'mlaen "),
   (" ni'wan "," ni 'wan "),
   (" fi'wneud "," fi 'wneud "),
   (" ta-ra'wan "," ta-ra 'wan "),
   (" o'nghariad "," o' nghariad "),
   (" ti'mond "," ti 'mond "),
   (" Steffan'na "," Steffan 'na "),
   (" o'na "," o 'na "),
   (" crys'na "," crys 'na "),
   (" ond'na "," ond 'na "),
   (" d'eu'tha "," deu' 'tha "),
   (" ddaw'na "," ddaw 'na "),
   (" i'na' "," i 'na "),
   (" ella'neith "," ella 'neith "),
   (" briodas'ma "," briodas 'ma "),
   (" sy'na'wan "," sy' 'na 'wan "),
   (" le'ma "," le 'ma "),
   (" iawn'wan "," iawn 'wan "),
   (" fi'na "," fi 'na "),
   (" dyddiau'ma "," dyddiau 'ma "),
   (" ohonnoch "," ohonoch "),
   (" 'di'wneud "," 'di 'wneud "),
   (" di'tha "," di 'tha "),
   (" do's'na "," do's 'na "),
   (" hi'na "," hi 'na "),
   (" nol'ma "," nol 'ma "),
   (" llnau'ma "," llnau 'ma "),
   (" ond'mond "," ond 'mond "),
   (" mynd'mlaen'ma "," mynd 'mlaen 'ma "),
   (" job'ma "," job 'ma "),
   (" swydd'ma "," swydd 'ma "),
   (" bach'ma "," bach 'ma "),
   (" caria'mlaen "," caria 'mlaen "),
   (" fan'na'wan "," fan 'na 'wan "),
   (" o'wan "," o 'wan "),
   (" lawr'nei "," lawr 'nei "),
   (" roedd'na "," roedd 'na "),
   (" reit'na "," reit 'na "),
   (" 'sa'na "," 'sa 'na "),
   (" ti'ma "," ti 'ma "),
   (" a'neud "," a 'neud "),
   (" di'neud "," di 'neud "),
   (" yma'wan "," yma 'wan "),
   (" a'na "," a 'na "),
   (" babi'ma "," babi 'ma "),
   (" i'nhy "," i' nhy "),
   (" o'ngolwg "," o' ngolwg "),
   (" fasai'na "," fasai 'na "),
   (" pam'nest "," pam 'nest "),
   (" boi'ma "," boi 'ma "),
   (" a'nes "," a 'nes "),
   (" ella'mod "," ella 'mod "),
   (" fel'ma "," fel 'ma "),
   (" deu'thi "," deu' 'thi "),
   (" moyn'neud "," moyn 'neud "),
   (" fynny "," fyny "),
   (" o'musnes "," o' musnes "),
   (" heddlu'neud "," heddlu 'neud "),
   (" tribe'ma "," tribe 'ma "),
   (" chwaer-ysgol "," chwaer ysgol "),
   (" sgrin'na'wan "," sgrin 'na 'wan "),
   (" Dad'nath "," Dad 'nath "),
   (" cae'l "," ca'l "),
   (" plu'ma'nei "," plu 'ma 'nei "),
   (" leia'mond "," leia 'mond "),
   (" malawi'ma "," malawi 'ma "),
   (" wedyn'na "," wedyn 'na "),
   (" dal'igon "," dal 'igon "),
   (" sws'na "," sws 'na "),
   (" naddo'naeth "," naddo 'naeth "),
   (" ol'ma "," ol 'ma "),
   (" ddaw'ma "," ddaw 'ma "),
   (" llanast'na "," llanast 'na "),
   (" tro'ma "," tro 'ma "),
   (" genod'ma "," genod 'ma "),
   (" gweud'tha "," gweud 'tha "),
   (" 'dy'rioed "," 'dy 'rioed "),
   (" nhw'nath "," nhw 'nath "),
   (" fi'ngwash "," fi ngwash "),
   (" ychwannegol "," ychwanegol "),
   (" hapus'wan "," hapus 'wan "),
   (" ffordd'wan "," ffordd 'wan "),
   (" i'na "," i 'na "),
   (" iawn'rioed "," iawn 'rioed "),
   (" o'ngwaith "," o' ngwaith "),
   (" chdi'nghoelio "," chdi 'nghoelio "),
   (" wel'nath "," wel 'nath "),
   (" pawb'na "," pawb 'na "),
   (" mae'nhroed "," mae nhroed "),
   (" o'rhoswch'rhoswch "," o 'rhoswch 'rhoswch "),
   (" bwrw'mlaen "," bwrw 'mlaen "),
   (" wel'neith "," wel 'neith "),
   (" tyd'nol "," tyd nol "),
   (" pwyll'wan "," pwyll 'wan "),
   (" i'tha "," i 'tha "),
   (" wedi'ngadael "," wedi ngadael "),
   (" nhw'na "," nhw 'na "),
   (" sori'mod "," sori 'mod "),
   (" na'sa "," na 'sa "),
   (" dy'unan "," dy 'unan "),
   (" chi'mond "," chi 'mond "),
   (" amdani'wan "," amdani 'wan "),
   (" wedi'ny "," wedi 'ny "),
   (" troi'nheimladau "," troi nheimladau "),
   (" mae'nyfodol "," mae nyfodol "),
   (" hyn'tha "," hyn 'tha "),
   (" olygfa'ma "," olygfa 'ma "),
   (" gweithio-busnes "," gweithio busnes "),
   (" Murphy'na "," Murphy 'na "),
   (" offers'wan "," offers 'wan "),
   (" doedd'na "," doedd 'na "),
   (" ti'sho "," ti isho"),
   (" fynd'mlaen "," fynd 'mlaen "),
   (" reit'ma "," reit 'ma "),
   (" siwrnai'na "," siwrnai 'na "),
   (" i'nghar "," i nghar "),
   (" hottie'na "," hottie 'na "),
   (" nawddoglyd'na "," nawddoglyd 'na "),
   (" gormod'mlaen "," gormod mlaen "),
   (" enw'mechan "," enw 'mechan "),
   (" sy'nghariad "," sy' nghariad "),
   (" bydd'na "," bydd 'na "),
   (" nage'mai "," nage mai "),
   (" Grug'nathon "," Grug nathon "),
   (" ifanc'ma "," ifanc 'ma "),
   (" geiriau'ma "," geiriau 'ma "),
   (" gw'bod'na "," gw'bod 'na "),
   (" lot'well "," lot 'well "),
   (" llefrithi "," llefrith i"),
   (" gath'ma "," gath 'ma "),
   (" adra'rhen "," adre 'rhen "),
   (" haia'mond "," haia 'mond "),
   (" grinderfydda "," grinder fydda "),
   (" hwn'neud "," hwn 'neud "),
   (" dol'wan "," dol 'wan "),
   (" babysitter'ma "," babysitter 'ma "),
   (" ystafell'ma "," ystafell 'ma "),
   (" bagiau'na "," bagiau 'na "),
   (" fel'ny "," fel 'ny "),
   (" mewn'chydig "," mewn 'chydig "),
   (" dydy'mysellfwrdd "," dydy mysellfwrdd "),
   (" fawr'na "," fawr 'na "),
   (" sara'nghariad "," sara nghariad "),
   (" rhoi'nhra'd "," rhoi nhra'd "),
   (" rwan'mlaen "," rwan mlaen "),
   (" lonydd'na "," lonydd 'na "),
   (" sbwriel'na "," sbwriel 'na "),
   (" witch'na'ndi "," witch 'na 'ndi "),
   (" bwyd'ndi "," bwyd 'ndi "),
   (" peth'ma "," peth 'ma "),
   (" plant'ne "," plant 'ne "),
   (" Stud'na "," Stud 'na "),
   (" ti'wneud "," ti wneud "),
   (" redeg'na "," redeg 'na "),
   (" five-a-side'wan "," five-a-side 'wan "),
   (" ond'naeth "," ond 'naeth "),
   (" ella'na "," ella 'na "),
   (" wedi'weud "," wedi 'weud "),
   (" bobl'ma "," bobl 'ma "),
   (" mai'mond "," mai 'mond "),
   (" 'mond'neud "," 'mond 'neud "),
   (" gwely'ma "," gwely 'ma "),
   (" cinio'na "," cinio 'na "),
   (" drio'neud "," drio 'neud "),
   (" gwersi'ma "," gwersi 'ma "),
   (" arolwg'na "," arolwg 'na "),
   (" i'nghegin "," i nghegin "),
   (" chi'naeth "," chi 'naeth "),
   (" ddysgu'nosbarth "," ddysgu nosbarth "),
   (" mae'run "," mae 'r'un "),
   (" chips'ma "," chips 'ma "),
   (" ol'wan "," ol 'wan "),
   (" flynydde'ma "," flynydde 'ma "),
   (" hyn'im "," hyn 'im "),
   (" r'wbeth'wan "," r'wbeth 'wan "),
   (" rhywbeth'mlaen "," rhywbeth 'mlaen "),
   (" Mam'mond "," Mam 'mond "),
   (" joint'ma "," joint 'ma "),
   (" dos'na "," dos 'na "),
   (" lwcus'nes "," lwcus 'nes "),
   (" ydy'ngwaith "," ydy ngwaith "),
   (" sbel'wan "," sbel 'wan "),
   (" achos'ny "," achos 'ny "),
   (" heb'rhen "," heb 'rhen "),
   (" fi'nei "," fi  nei "),
   (" hynmae "," hyn mae "),
   (" sprog'ma "," sprog 'ma "),
   (" gwaith'na "," gwaith 'na "),
   (" cwbl'na "," cwbl 'na "),
   (" pethau'mlaen "," pethau 'mlaen "),
   (" fwyd'ma "," fwyd 'ma "),
   (" i'nghefn "," i nghefn "),
   (" edrach'mlaen "," edrach 'mlaen "),
   (" deall'na "," deall 'na "),
   (" just'im "," just 'im "),
   (" chinks'im "," chinks 'im "),
   (" siop'wan "," siop 'wan "),
   (" footloose'wan "," footloose 'wan "),
   (" Linda'ma "," Linda 'ma "),
   (" deallt'ny "," deallt 'ny "),
   (" football'wan "," football 'wan "),
   (" 'i'neud "," 'i 'neud "),
   (" siop'ma "," siop 'ma "),
   (" cofia'mod "," cofia 'mod "),
   (" bwyd'ma "," bwyd 'ma "),
   (" am'na "," am 'na "),
   (" esiampl'wael "," esiampl wael "),
   (" na'mond "," na 'mond "),
   (" wedi'nghamddeall "," wedi nghamddeall "),
   (" 'dy'musnes "," 'dy 'musnes "),
   (" right'nawn "," right 'nawn "),
   (" ddim'wneud "," ddim 'wneud "),
   (" fwrw'mlaen "," fwrw 'mlaen "),
   (" fo'neith "," fo neith "),
   (" nhw'ma "," nhw 'ma "),
   (" ffenast'na "," ffenast 'na "),
   (" quits'wan "," quits 'wan "),
   (" cadw'mhlant "," cadw mhlant "),
   (" ardd'ma "," ardd 'ma "),
   (" cyfrifoldeb'wan "," cyfrifoldeb 'wan "),
   (" medi'na "," medi 'na "),
   (" ow'ma "," ow 'ma "),
   (" costio'ndi "," costio 'ndi "),
   (" dere'ma'nei "," dere 'ma 'nei "),
   (" wi'ma "," wi 'ma "),
   (" 'de'ngwas "," 'de ngwas "),
   (" ryg'ma "," ryg 'ma "),
   (" bres'tha "," bres 'tha "),
   (" bwyta'tha "," bwyta 'tha "),
   (" i'eisiau "," i eisiau "),
   (" chdi'nol "," chdi 'nol "),
   (" o'neud "," o 'neud "),
   (" Rita'na "," Rita 'na "),
   (" lol'ma "," lol 'ma "),
   (" nhw'mond "," nhw 'mond "),
   (" funud'nei "," funud 'nei "),
   (" nawr'mlaen "," nawr 'mlaen "),
   (" heb'wneud "," heb 'wneud "),
   (" stopio'neu "," stopio 'neu "),
   (" ydy'mod "," ydy 'mod "),
   (" dwli'ma "," dwli 'ma "),
   (" os'wnes "," os 'wnes "),
   (" snichyn'na "," snichyn 'na "),
   (" fenter'ma "," fenter 'ma "),
   (" du'na "," du 'na "),
   (" cerddi'na "," cerddi 'na "),
   (" benderfynu'ne "," benderfynu 'ne "),
   (" nol'na "," nol 'na "),
   (" pethau'ma'chos'mod "," pethau 'ma 'chod 'mod "),
   (" tydi'ngwas "," tydi ngwas "),
   (" newydd'neud "," newydd 'neud "),
   (" camddallt'nath "," camddallt 'nath "),
   (" y'warae "," y 'warae "),
   (" tynnu'mlaen "," tynnu 'mlaen "),
   (" o'with "," o with "),
   (" gurkhas'na "," gurkhas 'na "),
   (" i'mhen "," i mhen "),
   (" ei'neud "," ei neud "),
   (" sori'im "," sori 'im "),
   (" Gemma'ma "," Gemma 'ma "),
   (" naddo'mond "," naddo 'mond "),
   (" chdi'wan "," chdi 'wan "),
   (" meddwl'mod "," meddwl 'mod "),
   (" Eric'ma "," Eric 'ma "),
   (" hithau'rioed "," hithau 'rioed "),
   (" meddwl'im "," meddwl 'im "),
   (" torri'nghalon "," torri nghalon "),
   (" mater'mond "," mater 'mond "),
   (" weld'na "," weld 'na "),
   (" mae'nghof "," mae nghof "),
   (" ystyried'mod "," ystyried 'mod "),
   (" hwn'wan "," hwn 'wan "),
   (" gym'ma "," gym 'ma "),
   (" drosti'nes "," drosti nes "),
   (" goriad'wan "," goriad 'wan "),
   (" 'di'o "," 'di 'o "),
   (" diweddar'ma "," diweddar 'ma "),
   (" sortio'mhen "," sortio mhen "),
   (" fy'chwarter "," fy chwarter "),
   (" a'chwarter "," a chwarter "),
   (" fy'ngwaith "," fy ngwaith "),
   (" Rees'na "," Rees 'na "),
   (" wedi'nghyhuddo "," wedi nghyhuddo "),
   (" marvellous'wan "," marvellous 'wan "),
   (" adroddiad'na "," adroddiad 'na "),
   (" gath'na "," gath 'na "),
   (" bost'ma "," bost 'ma "),
   (" ddaru'na "," ddaru 'na "),
   (" hysterectomy'ma "," hysterectomy 'ma "),
   (" wrthi'tha "," wrthi 'tha "),
   (" goro'neud "," goro' 'neud "),
   (" on'wan "," on 'wan "),
   (" ychwanegol'ma "," ychwanegol 'ma "),
   (" sefyll'na "," sefyll 'na "),
   (" llofftdrws "," llofft drws "),
   (" pizzas'ma "," pizzas 'ma "),
   (" gyrraedd'na "," gyrraedd 'na "),
   (" bihafia'nei "," bihafia 'nei "),
   (" a'nghamddallt "," a nghamddallt "),
   (" meindio'mod "," meindio 'mod "),
   (" phones'na "," phones 'na "),
   (" busnes'na "," busnes 'na "),
   (" plentynnaidd'ma "," plentynaidd 'ma "),
   (" hira'mywyd "," hira' mywyd "),
   (" eisiau'musnes "," eisiau musnes "),
   (" croesi'mysadd "," croesi mysadd "),
   (" well'na "," well 'na "),
   (" olchi'nwylo "," olchi nwylo "),
   (" gwerthu'wan "," gwerthu 'wan "),
   (" 'heina'ma "," 'heina 'ma "),
   (" codi'mron "," codi mron "),
   (" personol 'ma "," personol 'ma "),
   (" gwir'tha "," gwir 'tha "),
   (" a'ny "," a 'ny "),
   (" 'sho'wan "," 'sho 'wan "),
   (" plant'na "," plant 'na "),
   (" Jac'neud "," Jac 'neud "),
   (" camera'ma "," camera 'ma "),
   (" chdi'nde "," chdi 'nde "),
   (" edrach'chi "," edrach chi "),
   (" ddesg'ma "," ddesg 'ma "),
   (" dwad'wan "," dwad 'wan "),
   (" o'run "," o 'run "),
   (" cerddoriaeth'na "," cerddoriaeth 'na "),
   (" mamogram'ma "," mamogram 'ma "),
   (" addo'neud "," addo 'neud "),
   (" llythyr'ma "," llythyr 'ma "),
   (" dacsi'na "," dacsi 'na "),
   (" weights'ma "," weights 'ma "),
   (" iawn'mond "," iawn 'mond "),
   (" mops'ma "," mops 'ma "),
   (" ti'neud'ny "," ti 'neud 'ny "),
   (" gau'ngheg "," gau ngheg "),
   (" gadw'nghaniau "," gadw nghaniau "),
   (" efo'chydig "," efo 'chydig "),
   (" ddweud'tha "," ddweud 'tha "),
   (" cerwch'wan "," cerwch 'wan "),
   (" cynta'ma "," cynta 'ma "),
   (" gallu'neud "," gallu 'neud "),
   (" gwirion'na "," gwirion 'na "),
   (" newydd'ma "," newydd 'ma "),
   (" bws'na "," bws 'na "),
   (" cerbyd'ma "," cerbyd 'ma "),
   (" ffaelu'wneud "," ffaelu 'wneud "),
   (" bwra'mlaen "," bwra 'mlaen "),
   (" priodi 'wan "," priodi 'wan "),
   (" greer'na "," greer 'na "),
   (" noswaith'na "," noswaith 'na "),
   (" i'wan "," i 'wan "),
   (" i'wneud "," i wneud "),
   (" fach'ma "," fach 'ma "),
   (" dal'im "," dal 'im "),
   (" Jini'nei "," Jini 'nei "),
   (" di'wan "," di 'wan "),
   (" Ellis'im "," Ellis 'im "),
   (" Lerpwl'na "," Lerpwl 'na "),
   (" maggot'ma "," maggot 'ma "),
   (" dowch'wan "," dowch 'wan "),
   (" enw'na "," enw 'na "),
   (" flaenoriaeth'wan "," flaenoriaeth 'wan "),
   (" cyn-gariad "," cyn gariad "),
   (" fydde'na "," fydde 'na "),
   (" bitch'na "," bitch 'na "),
   (" glustiau'wan "," glustiau 'wan "),
   (" O< "," O "),
   (" weud'tho "," weud 'tho "),
   (" minder-annwyd "," minder annwyd "),
   (" geg'nei "," geg nei "),
   (" bod'no "," bod 'no "),
   (" gyllell'na "," gyllell 'na "),
   (" poeni'ngwas "," poeni ngwas "),
   (" bugeiliol'ma "," bugeiliol 'ma "),
   (" brofiad'mond "," brofiad 'mond "),
   (" cyrraedd'ma "," cyrraedd 'ma "),
   (" Taid'wan "," Taid 'wan "),
   (" bach 'no "," bach 'no "),
   (" i'nhrin "," i nhrin "),
   (" o'ngofal "," o nghofal "),
   (" y'mond'chydig "," y 'mond 'chydig "),
   (" chdi'neud "," chdi 'neud "),
   (" laff'mond "," laff 'mond "),
   (" pam'im "," pam 'im "),
   (" od'chi "," od chi "),
   (" yn'wilo "," yn wilo "),
   (" make-up'ma "," make-up 'ma "),
   (" builder'na "," builder 'na "),
   (" dod'mlaen "," dod 'mlaen "),
   (" ella'nawn "," ella 'nawn "),
   (" ar'na' "," ar na "),
   (" ers'chydig "," ers 'chydig "),
   (" hyn'mlaen "," hyn 'mlaen "),
   (" o'chi "," o' chi "),
   (" ddeud'ia' "," ddeud ia "),
   (" i'ngwadd "," i ngwadd "),
   (" ffor'ma "," ffor' 'ma "),
   (" fin'neud "," fin 'neud "),
   (" fe'na "," fe 'na "),
   (" bod'ma "," bod 'ma "),
   (" idiots'na "," idiots 'na "),
   (" a'marnu ", "a marnu "),
   (" mlynedd'wan "," mlynedd 'wan "),
   (" medru'nhrysito "," medru nhrystio "),
   (" brechdanau'na "," brechdanau 'na "),
   (" siwr'wan "," siwr 'wan "),
   (" cock-up'ma "," cock-up 'ma "),
   (" heno'nawn "," heno 'nawn "),
   (" pethau'ma "," pethau 'ma "),
   (" fingers'wan "," fingers 'wan "),
   (" sut'neud "," sut 'neud "),
   (" blin'da "," blin 'da "),
   (" fi'newch "," fi newch "),
   (" pres'ma "," pres 'ma "),
   (" hwch'na "," hwch 'na "),
   (" cyfarfod'na "," cyfarfod 'na "),
   (" boi'na "," boi 'na "),
   (" ni'tha "," ni 'tha "),
   (" trio'ngora "," trio ngora "),
   (" wel'naethon "," wel naethon "),
   (" well'nes "," well nes "),
   (" os'na "," os 'na "),
   (" peintio'na "," peintio 'na "),
   (" 'di'neud'wan "," 'di 'neud 'wan "),
   (" gwneud'run "," gwneud 'run "),
   (" adra'wan "," adra 'wan "),
   (" gw'bod'ny "," gw'bod 'ny "),
   (" wirion'nei "," wirion 'nei "),
   (" bethau'neu "," bethau neu "),
   (" i'neu'wan "," i neu' 'wan "),
   (" naddo'nes "," naddo nes "),
   (" i'im "," i 'im "),
   (" feiseps'tha "," feiseps 'tha "),
   (" bwthyn'na "," bwthyn 'na "),
   (" be'wan "," be 'wan "),
   (" cwpan'ma "," cwpan 'ma "),
   (" fuddugoliaeth'ma "," fuddugoliaeth 'ma "),
   (" 'sti'na "," 'sti 'na "),
   (" brechdanau'ma "," brechdanau 'ma "),
   (" fod'ma "," fod 'ma "),
   (" o'dda "," o dda "),
   (" Madam'im "," Madam 'im "),
   (" loompas'ma "," loompas 'ma "),
   (" clwb'ma "," clwb 'ma "),
   (" ffwrdd-fatha "," ffwrdd fatha "),
   (" sandwiches'ma "," sandwiches 'ma "),
   (" sylw'ma "," sylw 'ma "),
   (" cheekbones'na "," cheekbones 'na "),
   (" os'nei "," os nei "),
   (" ti'im "," ti 'im "),
   (" ac'mond "," ac 'mond "),
   (" chi'neud "," chi 'neud "),
   (" waith'ma "," waith 'ma "),
   (" byd'ma "," byd 'ma "),
   (" nhw'wybod "," nhw 'wybod "),
   (" fyd'washi "," fyd 'washi "),
   (" ty'na "," ty 'na "),
   (" lle'ny "," lle 'ny "),
   (" trial'neud "," trial 'neud "),
   (" farddoni'ma "," farddoni 'ma "),
   (" ddi-ddiolch "," ddi ddiolch "),
   (" Nain'im "," Nain 'im "),
   (" Ann'na "," Ann 'na "),
   (" hallt'neith "," hallt neith "),
   (" mwng'ma "," mwng 'ma "),
   (" foddim "," fo ddim "),
   (" gyfadde'mod "," gyfadde 'mod "),
   (" bai'na "," bai 'na "),
   (" mae'ngwraig "," mae ngwraig "),
   (" yn'ware "," yn 'ware "),
   (" cael'run "," cael 'run "),
   (" e'nhreisio "," e nhreisio "),
   (" afiach'na "," afiach 'na "),
   (" chi'wneud "," chi wneud "),
   (" plat'ma "," plat 'ma "),
   (" glwb'na "," glwb 'na "),
   (" thugs'na "," thugs 'na "),
   (" crys'ma "," crys 'ma "),
   (" broses'ma "," broses 'ma "),
   (" arolwg'ma "," arolwg 'ma "),
   (" iawn'mechan "," iawn mechan "),
   (" botel'na "," botel 'na "),
   (" p'naw'ma "," p'nawn 'ma "),
   (" edrych'mlan "," edrych 'mlan "),
   (" Guto'nde "," Guto 'nde "),
   (" ym'nawn "," ym nawn "),
   (" pryd'ny "," pryd 'ny "),
   (" ty'd'wan "," ty'd 'wan "),
   (" Gwenan'wan "," Gwenan 'wan "),
   (" 'sa'mrawd "," 'sa mrawd "),
   (" yma'nei "," yma 'nei "),
   (" cwpl'ma "," cwpl 'ma "),
   (" lico'na "," lico 'na "),
   (" fy'nhyllwr "," fy nhyllwr "),
   (" falch'wan "," falch 'wan "),
   (" mae'mhres "," mae mhres "),
   (" gobeithio'naiff "," gobeithio 'naiff "),
   (" haul'ma "," haul 'ma "),
   (" polyn'na "," polyn 'na "),
   (" paid'neud "," paid 'neud "),
   (" dewch'wan "," dewch 'wan "),
   (" barmaid'nahandlo "," barmaid 'na handlo "),
   (" os'wnawn "," os wnawn "),
   (" pwysica'mywyd "," pwysica' mywyd "),
   (" gwir'tho "," gwir 'tho "),
   (" ti'ngwas "," ti ngwas "),
   (" o'nosbarthiadau "," o nosbarthiadau "),
   (" a'nghasgliad "," a nghasgliad "),
   (" stopio'meirniadu "," stopio meirniadu "),
   (" 'li'udish "," 'li 'udish "),
   (" i'ngwers "," i ngwers "),
   (" ti'wbath "," ti 'wbath "),
   (" funud'ma "," funud 'ma "),
   (" heddiw'nath "," heddiw 'nath "),
   (" 'weud'tho "," 'weud 'tho "),
   (" gwrs'ny "," gwrs 'ny "),
   (" i'ma "," i 'ma "),
   (" erbyn'wan "," erbyn 'wan "),
   (" na'sach "," na 'sach "),
   (" cyflegwerthfawr "," cyfle gwerthfawr "),
   (" Cheryl'wan "," Cheryl 'wan "),
   (" 'neud'ma "," 'neud 'ma "),
   (" 'm'well "," 'm 'well "),
   (" tasai'nhal "," tasai nhal "),
   (" ffilm'mlaen "," ffilm 'mlaen "),
   (" reception'ma "," reception 'ma "),
   (" ordors'wan "," ordors 'wan "),
   (" i'neu'na "," i 'neu 'na "),
   (" golchi'nillad "," golchi nillad "),
   (" hwn'mlaen "," hwn 'mlaen "),
   (" shwsh'wan "," shwsh 'wan "),
   (" ddwy'na "," ddwy 'na "),
   (" amboutu'nheimladau "," amboutu nheimladau "),
   (" chdi'ma "," chdi 'ma "),
   (" fasa'na ", "fasa 'na "),
   (" ddiddordeb'ma "," ddiddordeb 'ma "),
   (" falle'nes "," falle 'nes "),
   (" am'ny "," am 'ny "),
   (" seign'na "," seign 'na "),
   (" gan'na "," gan 'na "),
   (" bocsys'ma "," bocsys 'ma "),
   (" o'ma'wan "," o 'ma 'wan "),
   (" fargan'washi "," fargan 'washi "),
   (" gwed'tho "," gwed 'tho "),
   (" dad'na "," dad 'na "),
   (" ddim'ny "," ddim 'ny "),
   (" ddeu'tho "," ddeu' 'tho "),
   (" nacdw'mond "," nacdw 'mond "),
   (" Tim'ma "," Tim 'ma "),
   (" o'neith "," o 'neith "),
   (" wel'nes "," wel 'nes "),
   (" am'chydig "," am 'chydig "),
   (" Beca'ma "," Beca 'ma "),
   (" boddi'nath "," boddi 'nath "),
   (" ysbyty'na "," ysbyty 'na "),
   (" pam'naeth "," pam 'naeth "),
   (" chi'tha "," chi 'tha "),
   (" feddwl'wan "," feddwl 'wan "),
   (" bownsers'na "," bownsers 'na "),
   (" ca'l'neud "," ca'l 'neud "),
   (" i'mhriodas "," i mhriodas "),
   (" trip'ma "," trip 'ma "),
   (" daw'na "," daw 'na "),
   (" newid'wan "," newid 'wan "),
   (" ambouty'ny "," ambouty 'ny "),
   (" deud'thi "," deud 'thi "),
   (" fel'ne "," fel 'ne "),
   (" deud'ia' "," deud 'ia "),
   (' ddi-dast ',' ddi dast '),
   (" lwcus'mod "," lwcus 'mod "),
   (" godi'nghalon "," godi nghalon "),
   (" Jac'im "," Jac 'im "),
   (" broblam'wan "," broblam 'wan "),
   (" aralli "," arall i "),
   (" ni'ndi "," ni 'ndi "),
   (" unawd'ma "," unawd 'ma "),
   (" bocsio'ma "," bocsio 'ma "),
   (" dosbarth'ma "," dosbarth 'ma "),
   (" boi'nath'neud "," boi 'nath 'neud "),
   (" hwnna'nei "," hwnna 'nei "),
   (" i'neu "," i 'neu "),
   (" gobeithio'neith "," gobeithio 'neith "),
   (" os'wnewch "," os wnewch "),
   (" cariwch'mlaen "," cariwch 'mlaen "),
   (" eiliad'ma "," eiliad 'ma "),
   (" caffi'na "," caffi 'na "),
   (" ysgolion'ma "," ysgolion 'ma "),
   (" 'da'mhlentyn "," 'da 'mhlentyn "),
   (" medru'neud "," medru 'neud "),
   (" na'nosbarth "," na nosbarth "),
   (" 'do's'na "," 'do's 'na "),
   (" domestig'ma "," domestig 'ma "),
   (" brynu'ndw "," brynu 'ndw "),
   (" pobl'im ","pobl 'im "),
   (" am'neud "," am 'neud "),
   (" tyrd'ma "," tyrd 'ma "),
   (" allan'na "," allan 'na "),
   (" 'anobeithiol' "," anobeithiol "),
   (" ni'nde "," ni 'nde "),
   (" i'nghael "," i nghael "),
   (" rhyfadd'ma "," rhyfadd 'ma "),
   (" Ann'nei "," Ann 'nei "),
   (" chips'na "," chips 'na "),
   (" MR "," mistâr "),
   (" MISS "," mis "),
   (" MRS "," misus "),
   (" MS ", " mis "),
   (" M4 "," m four "),
   (" EDRCHCH "," EDRYCH "),
]

SPEAKER_START_TAG = '<SPEAKER>'
SPEAKER_END_TAG = '</SPEAKER>'

AGE_START_TAG = '<AGE>'
AGE_END_TAG = '</AGE>'

GENDER_START_TAG = '<GENDER>'
GENDER_END_TAG = '</GENDER>'


MALE_TAGS = ['<#G>']
FEMALE_TAGS = ['<#B>']

BACKGROUND_NOISE_TAGS = ["<#CER>"]

ACCENT_NORTH_TAGS = ['<#ACGOG>'] 
ACCENT_SOUTH_TAGS = ['<#ACDE>']

ALL_TAGS = MALE_TAGS + FEMALE_TAGS + BACKGROUND_NOISE_TAGS + ACCENT_NORTH_TAGS + ACCENT_SOUTH_TAGS


def clean(transcript):
    """
    Cleans up the given sentence removing any markup and normalizing non-alpha characters 
    """
    transcript = transcript.strip()
    tokens = tokenizer.tokenize(transcript)

    new_tokens = []     

    for t in tokens:
        new_token = ' ' + t + ' '
        for find, replace in FIND_REPLACE:
            new_token = new_token.replace(find, replace)
           
        tokenized_new_tokens = tokenizer.tokenize(new_token.strip())
        new_tokens.extend(tokenized_new_tokens)

    new_transcript = tokenizer.detokenize(new_tokens)
    new_transcript = tokenizer.remove_seperators(new_transcript).strip()

    return new_transcript


def tokens(transcript):
    return tokenizer.tokenize(transcript)


def remove_tags(transcript):
    for tag in ALL_TAGS:
        transcript = transcript.replace(tag, '')

    transcript = remove_tagged_range(SPEAKER_START_TAG, SPEAKER_END_TAG, transcript)
    transcript = remove_tagged_range(AGE_START_TAG, AGE_END_TAG, transcript)
    transcript = remove_tagged_range(GENDER_START_TAG, GENDER_END_TAG, transcript)

    return transcript.strip()


def remove_tagged_range(start_tag, end_tag, transcript):
    if start_tag in transcript and end_tag in transcript:
        start = transcript.index(start_tag)
        end = transcript.index(end_tag) + len(end_tag)
        transcript = transcript[0:start:] + transcript[end::]

    return transcript


def any_tag_in_transcript(tags, transcript):
    if any(tag in transcript for tag in tags):
        return True
    return False


def get_gender(transcript):
    if any_tag_in_transcript(MALE_TAGS, transcript): return 'male'
    if any_tag_in_transcript(FEMALE_TAGS, transcript): return 'female'
    return get_tagged_value(GENDER_START_TAG, GENDER_END_TAG, transcript)
    return ''

def get_accent(transcript):
    if any_tag_in_transcript(ACCENT_NORTH_TAGS, transcript): return 'cy_north'
    if any_tag_in_transcript(ACCENT_SOUTH_TAGS, transcript): return 'cy_south'
    return ''

def has_background(transcript):
    if any_tag_in_transcript(BACKGROUND_NOISE_TAGS, transcript): return True
    return False

def get_speaker_id(transcript):
    return get_tagged_value(SPEAKER_START_TAG, SPEAKER_END_TAG, transcript)

def get_age(transcript):
    return get_tagged_value(AGE_START_TAG, AGE_END_TAG, transcript)

def get_tagged_value(start_tag, end_tag, transcript):
    if start_tag in transcript and end_tag in transcript:
        result = re.search(start_tag + '(.*)' + end_tag, transcript)
        return result.group(1)
    return 


if __name__ == "__main__":
    print(clean("<SPEAKER>123</SPEAKER>Lot i 'neud."))
 
